-- -----------------------------------------------------------------------
-- Example import of GBIF occurrence data to specific schema in 
-- PostgreSQL database
-- -----------------------------------------------------------------------

--Parameters
\set db GBIF
\set sch public
\set import_path /home/boyle/bien/gnrs/gnrsmss/import_GBIF/data/
\set import_file '\'' :import_path 'occurrence_cleaned_sample.txt\''

CREATE DATABASE :"db";  -- Omit if already exists
\c :db
CREATE SCHEMA IF NOT EXISTS :"db";
SET SEARCH_PATH TO :"sch";

DROP TABLE IF EXISTS occurrence;
CREATE TABLE occurrence (
"gbifID" text,
"abstract" text,
"accessRights" text,
"accrualMethod" text,
"accrualPeriodicity" text,
"accrualPolicy" text,
"alternative" text,
"audience" text,
"available" text,
"bibliographicCitation" text,
"conformsTo" text,
"contributor" text,
"coverage" text,
"created" text,
"creator" text,
"date" text,
"dateAccepted" text,
"dateCopyrighted" text,
"dateSubmitted" text,
"description" text,
"educationLevel" text,
"extent" text,
"format" text,
"hasFormat" text,
"hasPart" text,
"hasVersion" text,
"identifier" text,
"instructionalMethod" text,
"isFormatOf" text,
"isPartOf" text,
"isReferencedBy" text,
"isReplacedBy" text,
"isRequiredBy" text,
"isVersionOf" text,
"issued" text,
"language" text,
"license" text,
"mediator" text,
"medium" text,
"modified" text,
"provenance" text,
"publisher" text,
"references" text,
"relation" text,
"replaces" text,
"requires" text,
"rights" text,
"rightsHolder" text,
"source" text,
"spatial" text,
"subject" text,
"tableOfContents" text,
"temporal" text,
"title" text,
"type" text,
"valid" text,
"institutionID" text,
"collectionID" text,
"datasetID" text,
"institutionCode" text,
"collectionCode" text,
"datasetName" text,
"ownerInstitutionCode" text,
"basisOfRecord" text,
"informationWithheld" text,
"dataGeneralizations" text,
"dynamicProperties" text,
"occurrenceID" text,
"catalogNumber" text,
"recordNumber" text,
"recordedBy" text,
"individualCount" text,
"organismQuantity" text,
"organismQuantityType" text,
"sex" text,
"lifeStage" text,
"reproductiveCondition" text,
"behavior" text,
"establishmentMeans" text,
"occurrenceStatus" text,
"preparations" text,
"disposition" text,
"associatedReferences" text,
"associatedSequences" text,
"associatedTaxa" text,
"otherCatalogNumbers" text,
"occurrenceRemarks" text,
"organismID" text,
"organismName" text,
"organismScope" text,
"associatedOccurrences" text,
"associatedOrganisms" text,
"previousIdentifications" text,
"organismRemarks" text,
"materialSampleID" text,
"eventID" text,
"parentEventID" text,
"fieldNumber" text,
"eventDate" text,
"eventTime" text,
"startDayOfYear" text,
"endDayOfYear" text,
"year" text,
"month" text,
"day" text,
"verbatimEventDate" text,
"habitat" text,
"samplingProtocol" text,
"samplingEffort" text,
"sampleSizeValue" text,
"sampleSizeUnit" text,
"fieldNotes" text,
"eventRemarks" text,
"locationID" text,
"higherGeographyID" text,
"higherGeography" text,
"continent" text,
"waterBody" text,
"islandGroup" text,
"island" text,
"countryCode" text,
"stateProvince" text,
"county" text,
"municipality" text,
"locality" text,
"verbatimLocality" text,
"verbatimElevation" text,
"verbatimDepth" text,
"minimumDistanceAboveSurfaceInMeters" text,
"maximumDistanceAboveSurfaceInMeters" text,
"locationAccordingTo" text,
"locationRemarks" text,
"decimalLatitude" text,
"decimalLongitude" text,
"coordinateUncertaintyInMeters" text,
"coordinatePrecision" text,
"pointRadiusSpatialFit" text,
"verbatimCoordinateSystem" text,
"verbatimSRS" text,
"footprintWKT" text,
"footprintSRS" text,
"footprintSpatialFit" text,
"georeferencedBy" text,
"georeferencedDate" text,
"georeferenceProtocol" text,
"georeferenceSources" text,
"georeferenceVerificationStatus" text,
"georeferenceRemarks" text,
"geologicalContextID" text,
"earliestEonOrLowestEonothem" text,
"latestEonOrHighestEonothem" text,
"earliestEraOrLowestErathem" text,
"latestEraOrHighestErathem" text,
"earliestPeriodOrLowestSystem" text,
"latestPeriodOrHighestSystem" text,
"earliestEpochOrLowestSeries" text,
"latestEpochOrHighestSeries" text,
"earliestAgeOrLowestStage" text,
"latestAgeOrHighestStage" text,
"lowestBiostratigraphicZone" text,
"highestBiostratigraphicZone" text,
"lithostratigraphicTerms" text,
"group" text,
"formation" text,
"member" text,
"bed" text,
"identificationID" text,
"identificationQualifier" text,
"typeStatus" text,
"identifiedBy" text,
"dateIdentified" text,
"identificationReferences" text,
"identificationVerificationStatus" text,
"identificationRemarks" text,
"taxonID" text,
"scientificNameID" text,
"acceptedNameUsageID" text,
"parentNameUsageID" text,
"originalNameUsageID" text,
"nameAccordingToID" text,
"namePublishedInID" text,
"taxonConceptID" text,
"scientificName" text,
"acceptedNameUsage" text,
"parentNameUsage" text,
"originalNameUsage" text,
"nameAccordingTo" text,
"namePublishedIn" text,
"namePublishedInYear" text,
"higherClassification" text,
"kingdom" text,
"phylum" text,
"class" text,
"order" text,
"family" text,
"genus" text,
"subgenus" text,
"specificEpithet" text,
"infraspecificEpithet" text,
"taxonRank" text,
"verbatimTaxonRank" text,
"vernacularName" text,
"nomenclaturalCode" text,
"taxonomicStatus" text,
"nomenclaturalStatus" text,
"taxonRemarks" text,
"datasetKey" text,
"publishingCountry" text,
"lastInterpreted" text,
"elevation" text,
"elevationAccuracy" text,
"depth" text,
"depthAccuracy" text,
"distanceAboveSurface" text,
"distanceAboveSurfaceAccuracy" text,
"issue" text,
"mediaType" text,
"hasCoordinate" text,
"hasGeospatialIssues" text,
"taxonKey" text,
"acceptedTaxonKey" text,
"kingdomKey" text,
"phylumKey" text,
"classKey" text,
"orderKey" text,
"familyKey" text,
"genusKey" text,
"subgenusKey" text,
"speciesKey" text,
"species" text,
"genericName" text,
"acceptedScientificName" text,
"verbatimScientificName" text,
"typifiedName" text,
"protocol" text,
"lastParsed" text,
"lastCrawled" text,
"repatriated" text,
"relativeOrganismQuantity" text,
"recordedByID" text,
"identifiedByID" text,
"level0Gid" text,
"level0Name" text,
"level1Gid" text,
"level1Name" text,
"level2Gid" text,
"level2Name" text,
"level3Gid" text,
"level3Name" text
); 

-- Import the file
COPY occurrence FROM :import_file WITH (FORMAT 'text', NULL '');

-- Remove the header
DELETE FROM occurrence WHERE ctid=(SELECT ctid FROM occurrence ORDER BY ctid LIMIT 1);
